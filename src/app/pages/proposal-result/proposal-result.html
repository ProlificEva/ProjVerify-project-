<div class="top-bar">
    <span>Verification Report</span>
    <button (click)="dashboard()" class="btn-nav">Dashboard</button>
</div>

<div *ngIf="isLoading" class="loading-overlay">
  <div class="spinner"></div>
  <p>Analyzing Plagiarism & AI Probability...</p>
</div>

<main class="main-content" *ngIf="!isLoading">
  <div class="content-grid">
    <div class="section">
      <h1 class="section-title">Submission Details</h1>

      <div class="detail-group">
        <div class="detail-label">Project Title</div>
        <div class="detail-value">"{{ proposalData?.title || 'Untitled Project' }}"</div>
      </div>

      <div class="detail-row">
        <div class="detail-group">
          <div class="detail-label">Submitted By</div>
          <div class="detail-value">{{ currentUser?.name }}</div>
        </div>
        <div class="detail-group">
          <div class="detail-label">Department</div>
          <div class="detail-value">{{ currentUser?.department }}</div>
        </div>
      </div>

      <div class="detail-group">
        <div class="detail-label">Abstract Overview</div>
        <div class="detail-value abstract-text">{{ proposalData?.abstract }}</div>
      </div>
    </div>

    <div class="section">
      <h2 class="section-title">AI Validation Result</h2>

      <div class="score-container">
        <div class="score-gauge">
          <div class="gauge-background">
            <div class="gauge-fill" [style.transform]="getGaugeRotation()" [style.background]="getStatusColor()"></div>
          </div>
        </div>
        <div class="score-text">
          <div class="score-label">Originality Score:</div>
          <div class="score-value">{{ reportData?.originalityScore }}</div>
          <div class="score-status" [style.color]="getStatusColor()">{{ reportData?.status }}</div>
        </div>
      </div>

      <h3 class="sub-title">Similarity Matches (Vector Search)</h3>

      <div class="excerpts-grid">
        <div class="excerpt-card" *ngFor="let project of reportData?.similarProjects">
          <div class="excerpt-title">Matching Project: "{{ project.title }}"</div>
          <div class="excerpt-text">
            <span class="match-badge">Similarity: {{ project.similarity }}</span>
            <p>Submission Date: {{ project.submittedOn }}</p>
          </div>
        </div>

        <div *ngIf="!reportData?.similarProjects || reportData?.similarProjects.length === 0" class="excerpt-card empty">
          <div class="excerpt-text">No similar historical projects detected in the database.</div>
        </div>
      </div>
    </div>
  </div>

  <div class="action-buttons">
    <button class="btn btn-approve" (click)="dashboard()">Done</button>
    <button class="btn btn-revision">Print Report</button>
  </div>
</main>